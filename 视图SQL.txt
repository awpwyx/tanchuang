SELECT  dbo.T_GL_VOUCHERENTRY.FEXPLANATION, dbo.T_GL_VOUCHERENTRY.FENTRYID AS FID, 
                   dbo.T_GL_VOUCHER.FBILLNO, dbo.T_GL_VOUCHER.FDATE AS FCREATEDATE, dbo.T_GL_VOUCHERENTRY.FDETAILID, 
                   dbo.T_GL_VOUCHERENTRY.FDEBIT - (CASE WHEN a.fcreate IS NULL THEN 0 ELSE a.fcreate END) AS FDEBIT, 
                   dbo.T_GL_VOUCHERENTRY.FCREDIT - (CASE WHEN a.fdebit1 IS NULL THEN 0 ELSE a.fdebit1 END) AS FCREDIT, 
                   dbo.T_BD_ACCOUNT.FNUMBER, dbo.T_BD_ACCOUNT_L.FNAME, (CASE WHEN t1_L.FNAME IS NULL 
                   THEN '' ELSE t1_L.FNAME + ',' END) + (CASE WHEN t2_L.FNAME IS NULL THEN '' ELSE t2_L.FNAME + ',' END) 
                   + (CASE WHEN t3_L.FNAME IS NULL THEN '' ELSE t3_L.FNAME + ',' END) + (CASE WHEN t4_L.FNAME IS NULL 
                   THEN '' ELSE t4_L.FNAME + ',' END) + (CASE WHEN t5_L.FNAME IS NULL THEN '' ELSE t5_L.FNAME + ',' END) 
                   + (CASE WHEN t6_L.FNAME IS NULL THEN '' ELSE t6_L.FNAME + ',' END) + (CASE WHEN t7_L.FNAME IS NULL 
                   THEN '' ELSE t7_L.FNAME + ',' END) + (CASE WHEN t8_L.FNAME IS NULL THEN '' ELSE t8_L.FNAME + ',' END) 
                   + (CASE WHEN t9_L.FDATAVALUE IS NULL THEN '' ELSE t9_L.FDATAVALUE + ',' END) 
                   + (CASE WHEN t10_L.FDATAVALUE IS NULL THEN '' ELSE t10_L.FDATAVALUE END) AS Expr1, 16394 AS FMODIFIERID, 
                   1 AS FUSEORGID, 16394 AS FCREATORID, 1 AS FCREATEORGID, '2021-03-22 19:33:53.000' AS FMODIFYDATE, 
                   1 AS FORGID
FROM      dbo.T_GL_VOUCHER LEFT OUTER JOIN
                   dbo.T_GL_VOUCHERENTRY ON 
                   dbo.T_GL_VOUCHER.FVOUCHERID = dbo.T_GL_VOUCHERENTRY.FVOUCHERID LEFT OUTER JOIN
                   dbo.T_BD_ACCOUNT ON dbo.T_GL_VOUCHERENTRY.FACCOUNTID = dbo.T_BD_ACCOUNT.FACCTID LEFT OUTER JOIN
                   dbo.T_BD_ACCOUNT_L ON dbo.T_BD_ACCOUNT_L.FACCTID = dbo.T_BD_ACCOUNT.FACCTID AND 
                   dbo.T_BD_ACCOUNT_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BD_FLEXITEMDETAILV ON 
                   dbo.T_GL_VOUCHERENTRY.FDETAILID = dbo.T_BD_FLEXITEMDETAILV.FID LEFT OUTER JOIN
                   dbo.T_BD_SUPPLIER_L AS t1_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX4 = t1_L.FSUPPLIERID AND 
                   t1_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BD_DEPARTMENT_L AS t2_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX5 = t2_L.FDEPTID AND 
                   t2_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BD_CUSTOMER_L AS t3_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX6 = t3_L.FCUSTID AND 
                   t3_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_HR_EMPINFO_L AS t4_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX7 = t4_L.FID AND 
                   t4_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BD_MATERIAL_L AS t5_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX8 = t5_L.FMATERIALID AND 
                   t5_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BD_EXPENSE_L AS t6_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX9 = t6_L.FEXPID AND 
                   t6_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_FA_ASSETTYPE_L AS t7_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX10 = t7_L.FID AND 
                   t7_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_ORG_ORGANIZATIONS_L AS t8_L ON dbo.T_BD_FLEXITEMDETAILV.FFLEX11 = t8_L.FORGID AND 
                   t8_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BAS_ASSISTANTDATAENTRY_L AS t9_L ON dbo.T_BD_FLEXITEMDETAILV.FF100002 = t9_L.FENTRYID AND 
                   t9_L.FLOCALEID = 2052 LEFT OUTER JOIN
                   dbo.T_BAS_ASSISTANTDATAENTRY_L AS t10_L ON dbo.T_BD_FLEXITEMDETAILV.FF100003 = t10_L.FENTRYID AND 
                   t10_L.FLOCALEID = 2052 LEFT OUTER JOIN
                       (SELECT  SUM(FDEBIT) AS 'fdebit1', SUM(FCREDIT) AS 'fcreate', F_ORA_TEXT2
                        FROM       dbo.T_GL_VOUCHERENTRY AS T_GL_VOUCHERENTRY_1
                        WHERE    (F_ORA_TEXT2 <> '')
                        GROUP BY F_ORA_TEXT2) AS a ON a.F_ORA_TEXT2 = dbo.T_GL_VOUCHERENTRY.FENTRYID
WHERE   (dbo.T_GL_VOUCHERENTRY.FACCOUNTID IN (100067, 100057, 100056, 100066)) AND 
                   (dbo.T_GL_VOUCHER.F_PAEZ_TEXT = '') AND (dbo.T_GL_VOUCHER.FBILLNO > 0) AND 
                   (0 < (CASE T_GL_VOUCHERENTRY.FACCOUNTID WHEN 100067 THEN FCREDIT WHEN 100057 THEN FDEBIT WHEN 100056 THEN
                    FDEBIT WHEN 100066 THEN FCREDIT ELSE 0 END))